<!DOCTYPE html>
<html lang="en">
<head>
    <title>Deploying ESP Applications</title>
    
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1">
    <meta name="description" content="ESP web framework">
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,700|Open+Sans:300italic,400,300,700' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Julius+Sans+One' rel='stylesheet' type='text/css'>
    <link href="https://embedthis.com/esp/doc/users/deploying.html" rel="canonical">
    <link href="../images/favicon.ico" rel="shortcut icon">
    <link href="../lib/semantic-ui/semantic.min.css" rel="stylesheet" type="text/css">
    <link href="../css/all.min.css" rel="stylesheet" type="text/css">
    <link href="../css/api.min.css" rel="stylesheet" type="text/css">
    

</head>
<body class="show-sidebar">
    <div class="sidebar">
        <div class="ui large left vertical inverted labeled menu">
            <div class="item">
                <a href="../index.html" class="logo">ESP Docs</a>
            </div>
            <div class="item">
                <a href="../index.html">
                    <b>General</b>
                </a>
                <div class="menu">
                    <a class="item" href="../index.html">ESP Overview</a>
                    <a class="item" href="../users/features.html">ESP Features</a>
                    <a class="item" href="https://embedthis.com/esp/download.html">Download</a>
                    <a class="item" href="../licensing/index.html">Licensing</a>
                </div>
            </div>
            <div class="item">
                <a href="../start/index.html">
                    <b>Getting Started</b>
                </a>
                <div class="menu">
                    <a class="item" href="../start/quick.html">Quick Start</a>
                    <a class="item" href="../start/installing.html">Installing ESP</a>
                    <a class="item" href="../start/tour.html">ESP Tour</a>
                    <a class="item" href="../start/app-tour.html">ESP Applications Tour</a>
                    <a class="item" href="../start/spa-tour.html">ESP SPA Tour</a>
                    <a class="item" href="../start/releaseNotes.html">Release Notes</a>
                    <a class="item" href="../start/source.html">Building from Source</a>
                </div>
            </div>
            <div class="item">
                <a href="../users/index.html"><b>User's Guide</b></a>
                <div class="menu">
                    <a class="item" href="../users/create.html">Creating ESP Applications</a>
                    <a class="item" href="../users/packages.html">Extension Packages</a>
                    <a class="item" href="../users/skeletons.html">Application Skeletons</a>
                    <a class="item" href="../users/config.html">Configuring ESP</a>
                    <a class="item" href="../users/components.html">Generating Components</a>
                    <a class="item" href="../users/building.html">Building Applications</a>
                    <a class="item" href="../users/deploying.html">Deploying Applications</a>
                    <a class="item" href="../users/pages.html">ESP Pages</a>
                    <a class="item" href="../users/layouts.html">Expansive Layouts</a>
                    <a class="item" href="../users/controllers.html">ESP Controllers</a>
                    <a class="item" href="../users/database.html">Databases</a>
                    <a class="item" href="../users/migrations.html">Database Migrations</a>
                    <a class="item" href="../users/sessions.html">Session Storage</a>
                    <a class="item" href="../users/security.html">Security Considerations</a>
                    <a class="item" href="../users/monitor.html">Monitoring and Defending</a>
                    <a class="item" href="../users/hosting.html">Hosting in Appweb</a>
                    <a class="item" href="../users/command.html">ESP Command</a>
                    <a class="item" href="../users/man.html">Manual Pages</a>
                </div>
            </div>
            <div class="item">
                <a href="../ref/index.html">Reference Guide</a>
                <div class="menu">
                    <a class="item" href="../ref/mvc.html">ESP MVC Framework</a>
                    <a class="item" href="../ref/compatibility.html">Compatibility</a>
                    <a class="item" href="../ref/native.html">API Library</a>
                    <a class="item" href="../ref/memory.html">ESP Memory Allocation</a>
                    <a class="item" href="../ref/multithread.html">Multithreaded Programming</a>
                </div>
            </div>
            <div class="item">
                <a href="../users/samples.html">Samples</a>
                <div class="menu">
                  <a class="item" href="https://github.com/embedthis/esp/tree/dev/samples/config">config</a>
                  <a class="item" href="https://github.com/embedthis/esp/tree/dev/samples/controller">controller</a>
                  <a class="item" href="https://github.com/embedthis/esp/tree/dev/samples/html-mvc">html-mvc</a>
                  <a class="item" href="https://github.com/embedthis/esp/tree/dev/samples/layout">layout</a>
                  <a class="item" href="https://github.com/embedthis/esp/tree/dev/samples/login-database">login-database</a>
                  <a class="item" href="https://github.com/embedthis/esp/tree/dev/samples/login-form">login-form</a>
                  <a class="item" href="https://github.com/embedthis/esp/tree/dev/samples/login-roles">login-roles</a>
                  <a class="item" href="https://github.com/embedthis/esp/tree/dev/samples/page">page</a>
                  <a class="item" href="https://github.com/embedthis/esp/tree/dev/samples/session">session</a>
                  <a class="item" href="https://github.com/embedthis/esp/tree/dev/samples/upload">upload</a>
                </div>
            </div>
            <div class="item">
                <a href="../users/project.html">Project Resources</a>
                <div class="menu">
                    <a class="item" href="https://embedthis.com/blog/categories/ESP/">Official ESP News</a>
                    <a class="item" href="https://embedthis.com/esp/">ESP Web Site</a>
                    <a class="item" href="https://github.com/embedthis/esp">Source Code Repository</a>
                    <a class="item" href="https://github.com/embedthis/esp/issues">Project Issue Database</a>
                    <a class="item" href="https://github.com/embedthis/esp/releases">Change Log</a>
                    <a class="item" href="https://github.com/embedthis/esp/milestones">Roadmap</a>
                    <a class="item" href="https://embedthis.com/developers/contributors.html">Contributors Agreement</a>
                </div>
            </div>
            <div class="item">
                <b>Links</b>
                <div class="menu">
                    <a class="item" href="https://embedthis.com/">Embedthis Web Site</a>
                    <a class="item" href="https://embedthis.com/blog/">Embedthis Blog</a>
                    <a class="item" href="http://twitter.com/embedthat">Twitter</a>
                </div>
            </div>
        </div>
    </div>



    <div class="ui inverted masthead">
        <div class="ui fixed inverted menu">
            <div class="ui sidebar-launch button">
                <i class="icon list layout"></i>
            </div>
            <div class="right menu">
                <a class="item" href="https://embedthis.com/">Embedthis</a>
                    <a class="item" href="https://embedthis.com/esp/">ESP Site</a>
                    <span class="desktop-only">
                        <a class="item" href="https://embedthis.com/blog/categories/ESP/">ESP News</a>
                        <a class="item" href="https://github.com/embedthis/esp">Repository</a>
                        <a class="item" href="https://embedthis.com/blog/">Blog</a>
                        <a class="item" href="https://twitter.com/embedthat">Twitter</a>
                    </span>

            </div>
        </div>
        
        <div class="ui breadcrumb">
            <a class="section" href="../">Home</a>
            
            <div class="divider">/</div>
            <a class="section" href="index.html">
                User's Guide
            </a>
            
            
            <div class="divider">/</div>
            <a class="active section" href="deploying.html">Deploying ESP Applications</a>
            
        </div>
        
        <iframe class="version desktop-only" src="../version.html"></iframe>

    </div>
    <div class="content">

        <h1>Deploying ESP Applications</h1>
        <p>When your ESP application has been built, you can select just the files and directories that are
        required for deployment to the live site. For security, it is recommended that you <em>not</em>
        copy the entire ESP application tree. Rather select only the files and directories that are actually
        required for the production application.</p>

        <h2>One Step Deploy</h2>

        <pre class="code">$ <b>expansive deploy</b></pre>

        <p>This copies the required files to the <em>./deploy</em> directory. You can also specify a deploy directory
        on the command line. For example:</p>

        <pre class="code">$ <b>expansive deploy /tmp/upload</b></pre>

        <p>This copies the required files to the <em>/tmp/upload</em> directory.</p>

        <h2>Files and Directories</h2>
        <p>These are the default files and directories that <em>expansive deploy</em> will deploy to the <em>./deploy</em>
            directory.</p>

        <table class="ui table" title="files">
            <thead>
                <tr><th>File/Directory<th>Contents</tr>
            </thead>
            <tbody>
                <tr>
                    <td>dist/</td>
                    <td>Public web content for the ESP application.</td>
                </tr>
                <tr>
                    <td>cache/</td>
                    <td>This directory contains the compiled ESP controllers and pages.</td>
                </tr>
                <tr>
                    <td>db/</td>
                    <td>Application database directory.</td>
                </tr>
                <tr>
                    <td>esp.json</td>
                    <td>The <em>esp.json</em> configures your ESP application.
                    </td>
                </tr>
                <tr>
                    <td>pak.json</td>
                    <td>The <em>pak.json</em> file defines the ESP application name and version.
                    </td>
                </tr>
            </tbody>
        </table>

        <h2>Customizing Deployment</h2>
        <p>The deploy command can be customized via the <em>control.deploy</em> property in the <em>expansive.json</em>
        file. For example:</p>

        <pre class="code">
{
    control: {
        deploy: {
            from: [
                "dist/**",
                "extra/*.pdf",
                "cache/*.dll",
                "cache/*.lib",
                "esp.json",
                "pak.json"
            ],
            to: "deploy",
            clean: true,
            script: ''
        }
    }
}
</pre>
        <h3>Using <em>control.deploy</em> Properties</h3>
        <table class="ui table" title="deploy">
            <thead>
                <tr><th>Property<th>Description</tr>
            </thead>
            <tbody>
                <tr><td>from<td>Array of source files. May contain wild-cards. Defaults to:
                    <em>['dist/**', 'cache/*', 'pak.json', 'esp.json']</em>.</tr>
                <tr><td>flatten<td>Do not preserve source directory structure. Defaults to <em>false</em>.</tr>
                <tr><td>to<td>Destination directory. Defaults to <em>./deploy</em>.</tr>
                <tr><td>clean<td>Remove the prior contents of the destination directory.</tr>
                <tr><td>script<td>Script to run after copying any specified files.</tr>
            </tbody>
        </table>

        <h3>Remote Deployment</h3>
        <p>You can use the <em>deploy.script</em> property to upload to a remote server. This example below creates
        a compressed tar file of the deploy contents and then uses a HTTP <em>put</em> request to upload to a server.</p>

        <pre class="code">
        {
  control: {
    deploy: {
      script: `
        require ejs.tar
        let file = Path('upload.tgz')
        Tar(file).create(Path('deploy').files('**', {directories: false}))
        let http = Http()
        http.put('http://example.com/' + file, file.readString())
        if (http.status != 200) {
            throw 'Cannot upload "' + file + '". Bad http status: ' + http.status  + '.'
        }
      `
    }
  }
}</pre>

        <h2>Deploying to different Architectures</h2>
        <p>If you are deploying to a different machine architecture, you will need to either cross-compile
        for that target or compile the ESP application on the target.
        See <a href="building.html#target">Building for Target Systems</a> for more details.</p>

    </div>
    <div class="terms ui basic center aligned segment">
        <p>&copy; Embedthis Software. All rights reserved.</p>
    </div>

    <script src="../lib/jquery/jquery.min.js"></script>
    <script src="../lib/semantic-ui/semantic.min.js"></script>
    <script src="../scripts/sidebar.min.js"></script>
     

    




